-- LocalScript: Rainbow Key GUI + run remote DNXHUB
-- Khi nh·∫≠p ƒë√∫ng key -> ch·∫°y:
-- loadstring(game:HttpGet("https://raw.githubusercontent.com/DuyNguIOD/DNX-HUB/refs/heads/main/DNXHUB.lua.txt"))()
-- Sau ƒë√≥ GUI b·ªã ·∫©n (Destroy)

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- ======= C·∫§U H√åNH =======
local REQUIRED_KEY = "DuyNguIOS On Top"
local COPY_LINK = "https://link4m.com/xTciEeY"
local REMOTE_RUN_LINE = 'https://raw.githubusercontent.com/DuyNguIOD/DNX-HUB/refs/heads/main/DNXHUB.lua.txt'
-- =========================

local function trySetClipboard(text)
    local ok = pcall(function()
        if setclipboard then
            setclipboard(text)
        elseif syn and syn.set_clipboard then
            syn.set_clipboard(text)
        elseif set_clipboard then
            set_clipboard(text)
        else
            error("no clipboard")
        end
    end)
    return ok
end

local function createRainbowKeyGui()
    -- remove old if exists
    local old = PlayerGui:FindFirstChild("DuyNguIOS_RainbowKeyGui")
    if old then old:Destroy() end

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "DuyNguIOS_RainbowKeyGui"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Name = "MainFrame"
    frame.Size = UDim2.new(0, 420, 0, 240)
    frame.Position = UDim2.new(0.5, -210, 0.5, -120)
    frame.AnchorPoint = Vector2.new(0.5, 0.5)
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    frame.BorderSizePixel = 0
    frame.Active = true
    frame.Parent = screenGui

    -- thin white border
    local stroke = Instance.new("UIStroke", frame)
    stroke.Thickness = 1
    stroke.Color = Color3.fromRGB(255,255,255)

    -- title
    local title = Instance.new("TextLabel", frame)
    title.Size = UDim2.new(1, -40, 0, 30)
    title.Position = UDim2.new(0, 10, 0, 6)
    title.BackgroundTransparency = 1
    title.Text = "Script by DuyNguIOS"
    title.TextColor3 = Color3.fromRGB(255,255,255)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 20
    title.TextXAlignment = Enum.TextXAlignment.Left

    -- close X
    local closeBtn = Instance.new("TextButton", frame)
    closeBtn.Size = UDim2.new(0, 28, 0, 28)
    closeBtn.Position = UDim2.new(1, -36, 0, 6)
    closeBtn.BackgroundTransparency = 1
    closeBtn.Text = "X"
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 20
    closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)

    -- key input
    local keyBox = Instance.new("TextBox", frame)
    keyBox.Name = "KeyBox"
    keyBox.Size = UDim2.new(0.9, 0, 0, 38)
    keyBox.Position = UDim2.new(0.05, 0, 0, 52)
    keyBox.PlaceholderText = "Nh·∫≠p key t·∫°i ƒë√¢y..."
    keyBox.Text = ""
    keyBox.Font = Enum.Font.Gotham
    keyBox.TextSize = 18
    keyBox.TextColor3 = Color3.fromRGB(255,255,255)
    keyBox.BackgroundColor3 = Color3.fromRGB(20,20,20)
    keyBox.BorderSizePixel = 1

    -- link label
    local linkLabel = Instance.new("TextLabel", frame)
    linkLabel.Size = UDim2.new(0.9, 0, 0, 24)
    linkLabel.Position = UDim2.new(0.05, 0, 0, 98)
    linkLabel.BackgroundTransparency = 1
    linkLabel.TextColor3 = Color3.fromRGB(255,0,0)
    linkLabel.Text = ""
    linkLabel.TextXAlignment = Enum.TextXAlignment.Left

    -- msg label
    local msgLabel = Instance.new("TextLabel", frame)
    msgLabel.Size = UDim2.new(0.9, 0, 0, 30)
    msgLabel.Position = UDim2.new(0.05, 0, 0, 195)
    msgLabel.BackgroundTransparency = 1
    msgLabel.Text = ""
    msgLabel.TextColor3 = Color3.fromRGB(255,255,255)
    msgLabel.TextWrapped = true

    -- buttons container
    local btnContainer = Instance.new("Frame", frame)
    btnContainer.Size = UDim2.new(0.9, 0, 0, 44)
    btnContainer.Position = UDim2.new(0.05, 0, 0, 128)
    btnContainer.BackgroundTransparency = 1

    local list = Instance.new("UIListLayout", btnContainer)
    list.FillDirection = Enum.FillDirection.Horizontal
    list.Padding = UDim.new(0.05, 0)
    list.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- GET KEY btn
    local getBtn = Instance.new("TextButton", btnContainer)
    getBtn.Size = UDim2.new(0.47, 0, 1, 0)
    getBtn.BackgroundColor3 = Color3.fromRGB(25,25,25)
    getBtn.Text = "GET KEY"
    getBtn.Font = Enum.Font.GothamBold
    getBtn.TextSize = 18
    getBtn.TextColor3 = Color3.fromRGB(255,0,0)
    getBtn.AutoButtonColor = true
    local stroke1 = Instance.new("UIStroke", getBtn)
    stroke1.Thickness = 1
    stroke1.Color = Color3.fromRGB(255,255,255)

    -- ENTER btn
    local enterBtn = Instance.new("TextButton", btnContainer)
    enterBtn.Size = UDim2.new(0.47, 0, 1, 0)
    enterBtn.BackgroundColor3 = Color3.fromRGB(25,25,25)
    enterBtn.Text = "ENTER"
    enterBtn.Font = Enum.Font.GothamBold
    enterBtn.TextSize = 18
    enterBtn.TextColor3 = Color3.fromRGB(0,200,0)
    enterBtn.AutoButtonColor = true
    local stroke2 = Instance.new("UIStroke", enterBtn)
    stroke2.Thickness = 1
    stroke2.Color = Color3.fromRGB(255,255,255)

    -- rainbow colors array (7 colors)
    local colors = {
        Color3.fromRGB(255, 0, 0),      -- red
        Color3.fromRGB(255, 127, 0),    -- orange
        Color3.fromRGB(255, 255, 0),    -- yellow
        Color3.fromRGB(0, 255, 0),      -- green
        Color3.fromRGB(0, 0, 255),      -- blue
        Color3.fromRGB(75, 0, 130),     -- indigo
        Color3.fromRGB(148, 0, 211)     -- violet
    }

    -- animate rainbow on frame background
    task.spawn(function()
        local idx = 1
        local duration = 0.6
        while screenGui.Parent do
            local nextIdx = idx % #colors + 1
            local tweenInfo = TweenInfo.new(duration, Enum.EasingStyle.Linear)
            local tween = TweenService:Create(frame, tweenInfo, {BackgroundColor3 = colors[nextIdx]})
            tween:Play()
            tween.Completed:Wait()
            idx = nextIdx
            task.wait(0.02)
        end
    end)

    -- Get Key action
    getBtn.MouseButton1Click:Connect(function()
        linkLabel.Text = COPY_LINK
        local ok = trySetClipboard(COPY_LINK)
        if ok then
            msgLabel.Text = "‚úÖ Link ƒë√£ ƒë∆∞·ª£c copy v√†o clipboard (n·∫øu m√¥i tr∆∞·ªùng h·ªó tr·ª£)."
        else
            msgLabel.Text = "‚ö†Ô∏è Kh√¥ng th·ªÉ copy t·ª± ƒë·ªông. Link ƒë√£ hi·ªÉn th·ªã - copy th·ªß c√¥ng."
        end
    end)

    -- Close X
    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    -- Run remote script when key matches
    local function runRemoteScript()
        msgLabel.Text = "üîÑ ƒêang t·∫£i v√† ch·∫°y script..."
        local ok, err = pcall(function()
            -- EXACT command you requested:
            loadstring(game:HttpGet("https://raw.githubusercontent.com/DuyNguIOD/DNX-HUB/refs/heads/main/DNXHUB.lua.txt"))()
        end)
        if ok then
            msgLabel.Text = "‚úÖ Script ƒë√£ ch·∫°y th√†nh c√¥ng. GUI s·∫Ω ·∫©n."
            task.wait(0.6)
            screenGui:Destroy()
        else
            msgLabel.Text = "‚ùå L·ªói khi ch·∫°y script: "..tostring(err)
        end
    end

    enterBtn.MouseButton1Click:Connect(function()
        if keyBox.Text == REQUIRED_KEY then
            runRemoteScript()
        else
            msgLabel.Text = "‚ùå Key sai!"
        end
    end)

    keyBox.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            enterBtn.MouseButton1Click:Fire()
        end
    end)

    -------------------------------------------------------------------
    -- DRAG SYSTEM (di chuy·ªÉn menu b·∫±ng tay/chu·ªôt)
    -------------------------------------------------------------------
    local dragging, dragInput, dragStart, startPos
    local function update(input)
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or
           input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    -------------------------------------------------------------------

    return screenGui
end

-- create it
createRainbowKeyGui()
